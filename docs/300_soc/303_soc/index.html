<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.123.7">
    <meta name="description" content="">
<meta name="author" content="map[email:&lt;i&gt;fname&lt;/i&gt;.&lt;i&gt;lname&lt;/i&gt;A T&lt;i&gt;kuleuven.be&lt;/i&gt; name:Jo Vliegen]">

    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>303 - System on Chip (SoC) :: HW/SW codesign</title>

    
    <link href="../../css/nucleus.css?1742287319" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1742287319" rel="stylesheet">
    <link href="../../css/hybrid.css?1742287319" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1742287319" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1742287319" rel="stylesheet">
    <link href="../../css/auto-complete.css?1742287319" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1742287319" rel="stylesheet">
    <link href="../../css/theme.css?1742287319" rel="stylesheet">
    <link href="../../css/tabs.css?1742287319" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1742287319" rel="stylesheet">
    
    <link href="../../css/theme-kul.css?1742287319" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1742287319"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script src=../../js/exercises.js></script> 
  </head>
  <body class="" data-url="../../300_soc/303_soc/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
  <img src="../../img/style/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
  <img src="../../img/style/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1742287319"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1742287319"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/course_hwswcodesign\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1742287319"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/10_compiling/" title="1 Setting the playing field" class="dd-item
        
        
        
        ">
      <a href="../../10_compiling/">
          1 Setting the playing field
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/10_compiling/11_programming/" title="1.1 - Programming the RISC-V" class="dd-item ">
        <a href="../../10_compiling/11_programming/">
        <i class='fas fa-book'></i> 1.1 - Programming the RISC-V
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/10_compiling/12_compiling_bare_metal/" title="1.2 - Compiling Bare Metal" class="dd-item ">
        <a href="../../10_compiling/12_compiling_bare_metal/">
        <i class='fas fa-book'></i> 1.2 - Compiling Bare Metal
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/10_compiling/13_linking_bare_metal/" title="1.3 - Linking Bare Metal" class="dd-item ">
        <a href="../../10_compiling/13_linking_bare_metal/">
        <i class='fas fa-book'></i> 1.3 - Linking Bare Metal
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/10_compiling/14_simulation/" title="1.4 - Simulation" class="dd-item ">
        <a href="../../10_compiling/14_simulation/">
        <i class='fas fa-book'></i> 1.4 - Simulation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/10_compiling/15_exercises/" title="1.5 - Exercises" class="dd-item ">
        <a href="../../10_compiling/15_exercises/">
        <i class='fas fa-pen'></i> 1.5 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/20_hw/" title="2 Making it work on hardware" class="dd-item
        
        
        
        ">
      <a href="../../20_hw/">
          2 Making it work on hardware
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/20_hw/21_current_situation/" title="2.1 - The current situation" class="dd-item ">
        <a href="../../20_hw/21_current_situation/">
        <i class='fas fa-book'></i> 2.1 - The current situation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/20_hw/22_wrapping/" title="2.2 - Wrapping it up" class="dd-item ">
        <a href="../../20_hw/22_wrapping/">
        <i class='fas fa-book'></i> 2.2 - Wrapping it up
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/20_hw/23_onemore/" title="2.3 - One more thing ..." class="dd-item ">
        <a href="../../20_hw/23_onemore/">
        <i class='fas fa-book'></i> 2.3 - One more thing ...
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/20_hw/24_go_fast/" title="2.4 - Go as fast as you can" class="dd-item ">
        <a href="../../20_hw/24_go_fast/">
        <i class='fas fa-book'></i> 2.4 - Go as fast as you can
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/20_hw/25_exercises/" title="2.5 - Exercises" class="dd-item ">
        <a href="../../20_hw/25_exercises/">
        <i class='fas fa-pen'></i> 2.5 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/30_counter/" title="3 Once upon a time(r)" class="dd-item
        
        
        
        ">
      <a href="../../30_counter/">
          3 Once upon a time(r)
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/30_counter/31_timer/" title="3.1 - SW Timer" class="dd-item ">
        <a href="../../30_counter/31_timer/">
        <i class='fas fa-book'></i> 3.1 - SW Timer
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/30_counter/32_timer_counter/" title="3.2 - HW Timer" class="dd-item ">
        <a href="../../30_counter/32_timer_counter/">
        <i class='fas fa-book'></i> 3.2 - HW Timer
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/30_counter/33_tcnt_use/" title="3.3 - Using TCNT" class="dd-item ">
        <a href="../../30_counter/33_tcnt_use/">
        <i class='fas fa-book'></i> 3.3 - Using TCNT
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/30_counter/34_cost/" title="3.4 - How much bang do you get for your buck?" class="dd-item ">
        <a href="../../30_counter/34_cost/">
        <i class='fas fa-book'></i> 3.4 - How much bang do you get for your buck?
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/30_counter/35_exercises/" title="3.5 - Exercises" class="dd-item ">
        <a href="../../30_counter/35_exercises/">
        <i class='fas fa-pen'></i> 3.5 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://studiegidswww.uhasselt.be/opleidingsonderdeel.aspx?a=2023&amp;i=3468&amp;n=4&amp;t=04"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://p.cygnus.cc.kuleuven.be/webapps/blackboard/execute/announcement?method=search&amp;context=course&amp;course_id=_1176295_1&amp;handle=cp_announcements&amp;mode=cpview"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>HWSW codesign</a> > <a href=''>3  System on Chip</a> > 303 - System on Chip (SoC)
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#memory-map">Memory map</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              303 - System on Chip (SoC)
            </h1>
          

        


<p>A system on a chip or <strong>SoC</strong> stands in contrast to the traditional PC or laptop which are organised around a motherboard. In the third Bachelor of this program an entire course was spent on this topic: System-on-Chip design and experimentation. If you need a refresher, please head over to <a href="https://kuleuven-diepenbeek.github.io/course_soc-lab/ch4_esw/1_driver/#installing-some-defines" target="_blank">the website</a>.</p>
<p>The figure below shows an example of a SoC that we can build with what was seen before. At the hearth of the system is the RISC-V processor (<strong>picorv32i</strong>). The bus system that connects all the components together is an <strong>APB bus</strong>. Critical readers might point out the <em>native</em> memory interface of the picorv32i does not fit the APB-bus. A custom adapter is made to make this connection feasible (<strong>APB adapter</strong>). As you might have already spotted, the picorv32i already comes with two other adapters: 1 for connecting to an AXI bus, and 1 for converting to a wishbone interface.</p>
<p><img src="../../img/300/soc.png" alt="soc"></p>
<p>The <strong>APB memory</strong> and the <strong>APB print</strong> components were already discussed. It is pointed out once more that both these components are actually <em>models</em>. The HDL code of these components is <strong>non-synthesisable</strong>, meaning: it&rsquo;s valid HDL code, but it cannot be converted into hardware.</p>
<p>Finally, the <strong>APB counter</strong> component was discussed in the previous page, and the <strong>APB dummy</strong> is simply a placeholder for any other core.</p>
<h2 id="memory-map">Memory map</h2>
<p>One question that is not solved yet is how <strong>memory mapped IO (MMIO)</strong> is configured. To make live a bit easier (<em>it&rsquo;s already too complicated anyway</em> &#x1f609;) the configuration is done in the package: <strong>PKG_hwswcodesign</strong>.</p>
<div class="multiHcolumn">
<div class="column" style="flex-basis: 45%">
<div class="code_caption">
    PKG_hwswcodesign.vhd
</div>    
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vhd" data-lang="vhd"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_BASE_ADDRESS_0 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;00000000&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_HIGH_ADDRESS_0 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;00003FFF&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_BASE_ADDRESS_1 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;80000000&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_HIGH_ADDRESS_1 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;80000004&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_BASE_ADDRESS_2 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;81000000&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_HIGH_ADDRESS_2 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;81000FFF&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_BASE_ADDRESS_3 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;81100000&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constant</span> C_HIGH_ADDRESS_3 <span style="color:#f92672">:</span> <span style="color:#66d9ef">STD_LOGIC_VECTOR</span>(C_DATA_WIDTH<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">downto</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">:=</span> <span style="color:#ae81ff">x&#34;81100FFF&#34;</span>;
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
</div>
<div class="column">
<div class="code_caption">
    firmware.lds
</div>    
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-s" data-lang="s"><span style="display:flex;"><span>SECTIONS {
</span></span><span style="display:flex;"><span>	.memory <span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>		. <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000000</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">*</span>(.init);
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">*</span>(.text);
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">*</span>(<span style="color:#f92672">*</span>);
</span></span><span style="display:flex;"><span>		. <span style="color:#f92672">=</span> <span style="color:#a6e22e">ALIGN</span>(<span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>		end <span style="color:#f92672">=</span> .;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
<p>These constants set both the base address and the high address of the four components. Which values you choose here, is completely up to you. One traditional technique is to have the memory start at 0x0. This is also reflected in the linker-script (<strong>firmware.lds</strong>).</p>
<p>Every component gets its base address (BA) and high address (HA) configured through <em>generics</em> (or <em>parameters</em> for you .v people). The component can/could/should/may/&hellip; check these limits to see whether or not communication is intended for them. The APB bus also checks this to determine if the component needs to be talked to or not. Don&rsquo;t forget to make the correct modification on <strong>ALL</strong> (package, component, and APB-bus) locations if you want to modify the memory map.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
		
			<a class="nav nav-next" href="../../10_compiling/" title="1 Setting the playing field" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1742287319"></script>
    <script src="../../js/perfect-scrollbar.min.js?1742287319"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1742287319"></script>
    <script src="../../js/jquery.sticky.js?1742287319"></script>
    <script src="../../js/featherlight.min.js?1742287319"></script>
    <script src="../../js/highlight.pack.js?1742287319"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1742287319"></script>
    <script src="../../js/learn.js?1742287319"></script>
    <script src="../../js/hugo-learn.js?1742287319"></script>
    
        
            <script src="../../mermaid/mermaid.js?1742287319"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

